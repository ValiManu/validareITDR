<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Validare ITDR | Dashboard</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	{% load static %}
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/20.2.4/css/dx.common.css">
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/20.2.4/css/dx.dark.compact.css">
	<link href="{% static 'css/transparent/app.min.css' %}" rel="stylesheet">
    <!-- DEV -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.4.0/polyfill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.1.1/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js"></script>
    <script type="text/javascript" src="https://cdn3.devexpress.com/jslib/20.2.4/js/dx.all.js"></script>

</head>
<body>
	<!-- begin page-cover -->
	<div class="page-cover"></div>
	<!-- end page-cover -->
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show">
		<span class="spinner"></span>
	</div>
	<!-- end #page-loader -->
	<!-- begin #page-container -->
	<div id="page-container" class="page-container fade page-sidebar-fixed page-header-fixed">
		<!-- begin #header -->
		<div id="header" class="header navbar-default">
			<!-- begin navbar-header -->
			<div class="navbar-header">
				<a href="{% url 'index'%}" class="navbar-brand"><span class="navbar-logo"></span> <b>Validare</b> ITDR</a>
			</div>
			<!-- end navbar-header -->
			<!-- begin header-nav -->
			<ul class="navbar-nav navbar-right">
				<li class="dropdown navbar-user">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">
						<div class="image image-icon bg-black text-grey-darker">
							<i class="fa fa-user"></i>
						</div>
						<span class="d-none d-md-inline">{{user.get_username.capitalize}}</span> <b class="caret"></b>
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<a href="{% url 'logout'%}?next={{request.path}}" class="dropdown-item">Log Out</a>
					</div>
				</li>
			</ul>
		</div>
		<div id="sidebar" class="sidebar">
			<div data-scrollbar="true" data-height="100%">
				<ul class="nav">
					<li class="nav-profile">
						<a href="javascript:;" data-toggle="nav-profile">
							<div class="cover with-shadow"></div>
							<div class="image image-icon bg-black text-grey-darker">
								<i class="fa fa-user"></i>
							</div>
							<div class="info">
								{{user.get_username.capitalize}}
							</div>
						</a>
					</li>
				</ul>
				<ul class="nav">
					<li class="active">
						<a href="#">
							<i class="fa fa-th-large"></i>
							<span>Rapoarte</span>
						</a>
					</li>
				</ul>
			</div>
		</div>



		<div id="content" class="content">
			<h1 class="page-header"> Rapoarte</h1>
			<div class="panel panel-inverse">
				<div class="panel-heading">
					<h4 class="panel-title">Vanzari</h4>
					<div class="panel-heading-btn">
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
					</div>
				</div>
				<div class="panel-body">
					<div id="gridContainer" class="table table-bordered"></div>
				</div>
			</div>
		</div>






	</div>
	<script>
		(function () {
			$("#gridContainer").dxDataGrid({
				dataSource: "http://127.0.0.1:7000/dashboard/sales-report/",
				paging: {
					pageSize: 5
				},
				pager: {
					showPageSizeSelector: true,
					allowedPageSizes: [5, 10, 20],
				},
				filterRow: {
					visible: true,
					applyFilter: "auto"
				},
				export: {
					enabled: true,
				},
				onExporting: function (e) {
					var workbook = new ExcelJS.Workbook();
					var worksheet = workbook.addWorksheet('Vanzari');

					DevExpress.excelExporter.exportDataGrid({
						component: e.component,
						worksheet: worksheet,
						autoFilterEnabled: true
					}).then(function () {
						workbook.xlsx.writeBuffer().then(function (buffer) {
							saveAs(new Blob([buffer], { type: 'application/octet-stream' }), 'Vanzari.xlsx');
						});
					});
					e.cancel = true;
				},
				columns: [{
					dataField: "campaign",
					caption: "Campanie"
				}, {
					dataField: "shop",
					caption: "Magazin"
				}, {
					dataField: "ticket_no",
					caption: "Numar Bon"
				}, {
					dataField: "date",
					caption: "Data",
					dataType: "datetime",
					format: "dd-MM-yyyy HH:mm",
					sortOrder: "desc"
				}, {
					dataField: "total_sale",
					caption: "Produse Vandute"
				}, {
					dataField: "prize",
					caption: "Premiu Acordat"
				}],
				onInitNewRow: function (e) {
					e.shop = 245;
				},
				showBorders: true
			});
		})();
	</script>
	<script src="{% static 'js/app.min.js' %}"></script>
	<script src="{% static 'custom_js/smartWizard.js' %}"></script>
</body>
</html>

