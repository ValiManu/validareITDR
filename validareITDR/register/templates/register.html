<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Self running | Register</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description">
	<meta content="" name="author">
	{% load static %}
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link href="{% static 'css/transparent/app.min.css' %}" rel="stylesheet">
</head>
<body class="pace-top">
	<div id="page-loader" class="fade show">
		<span class="spinner"></span>
	</div>
	<div id="page-container" class="fade">
		<div class="register register-with-news-feed">
			<div class="news-feed">
				<div class="news-image" style="background-image: url(/static/img/login-bg/login-bg-17.jpg)"></div>
			</div>
			<div class="right-content">
				<h1 class="register-header">
					Sign Up
					<small></small>
				</h1>
				<div class="register-content">
					<form method="POST" action="{% url 'register' %}" class="margin-bottom-0">
						{% csrf_token %}
						<label class="control-label">Username <span class="text-danger">*</span></label>
						<div class="row row-space-10">
							<div class="col-md-6 m-b-15">
								<input type="text" class="form-control" name="username" id="username" placeholder="Username" onchange="is_username()" required />
								<div class="invalid-feedback">Username already exists!</div>
							</div>
						</div>
						<label class="control-label">Name <span class="text-danger">*</span></label>
						<div class="row row-space-10">
							<div class="col-md-6 m-b-15">
								<input type="text" class="form-control" id='firstName' name="first_name" placeholder="First name" required />
							</div>
							<div class="col-md-6 m-b-15">
								<input type="text" class="form-control" id="lastName" name="last_name" placeholder="Last name" required />
							</div>
						</div>
						<label class="control-label">Email <span class="text-danger">*</span></label>
						<div class="row m-b-15">
							<div class="col-md-12">
								<input type="email" class="form-control" id="email" name="email" placeholder="Email address" onchange="is_email()" required />
								<div class="invalid-feedback">E-mail already exists!</div>
							</div>
						</div>
						<label class="control-label">Password <span class="text-danger">*</span></label>
						<div class="row m-b-15">
							<div class="col-md-12">
								<input type="password" class="form-control" id="password" name="password" placeholder="Password" required onchange="isPassword()" />
								<div class="invalid-feedback">Password must contain at least 6 characters, including UPPER/lowercase and numbers</div>
							</div>
						</div>
						<label class="control-label">Re-enter Password <span class="text-danger">*</span></label>
						<div class="row m-b-15">
							<div class="col-md-12">
								<input type="password" class="form-control" id="rePassword" name="re_password" placeholder="Re-enter Password" required onchange="reEnterPassword()" />
								<div class="invalid-feedback">Please enter the same Password as above</div>
							</div>
						</div>
						<div class="checkbox checkbox-css m-b-30">
							<div class="checkbox checkbox-css m-b-30">
								<input type="checkbox" id="agreement_checkbox" name="terms">
								<label for="agreement_checkbox">
									By clicking Sign Up, you agree to our <a href="javascript:;">Terms</a> and that you have read our <a href="javascript:;">Data Policy</a>, including our <a href="javascript:;">Cookie Use</a>.
								</label>
								<div class="invalid-feedback">Please indicate that you accept the Terms and Conditions</div>
							</div>
						</div>
						<div class="register-buttons">
							<button type="submit" class="btn btn-primary btn-block btn-lg" id="signUp" >Sign Up</button>
						</div>
						<div class="m-t-30 m-b-30 p-b-30">
							Already a member? Click <a href="{% url 'index' %}">here</a> to login.
						</div>
						<hr />
						<p class="text-center mb-0">
							&copy; Self Running All Right Reserved 2020
						</p>
					</form>
				</div>
			</div>
		</div>
	</div>
	<script src="{% static 'js/app.min.js' %}"></script>
	<script>
		var is_username = function () {
			var username = document.getElementById('username').value.toLowerCase();
			$.ajax({
				type: 'POST',
                url: "{% url 'is_username' %}",
				data: {
					'username': username
                },
				success: function (data) {
					if (data.data) {
                        $('#username').addClass('is-invalid');
                        $('#signUp').addClass('disabled');
                        $('#signUp').prop('type', 'button')
                    } else {
						$('#username').removeClass('is-invalid');
                        $('#signUp').removeClass('disabled');
                        $('#signUp').prop('type', 'submit')
                    }
                }
            });
		}

        var is_email = function () {
            var email = document.getElementById('email').value.toLowerCase();
            $.ajax({
                type: 'POST',
                url: "{% url 'is_email' %}",
				data: {
					'email': email
                },
                success: function (data) {
                    if (data.data) {
                        $('#email').addClass('is-invalid');
                        $('#signUp').addClass('disabled');
						$('#signUp').prop('type', 'button');
                    } else {
                        $('#email').removeClass('is-invalid');
                        $('#signUp').removeClass('disabled');
						$('#signUp').prop('type', 'submit');
                    }
                }
            });
		}

		var isPassword = function () {
			var password = document.getElementById('password').value;
			$.ajax({
				type: 'POST',
				url: "{% url 'is_password' %}",
				data: {
					'password': password
				},
				success: function (data) {
					if (data.data) {
						$('#password').addClass('is-invalid');
						$('#signUp').addClass('disabled');
						$('#signUp').prop('type', 'button');
					} else {
						$('#password').removeClass('is-invalid');
						$('#signUp').removeClass('disabled');
						$('#signUp').prop('type', 'submit');
					}
				}
			});
		}

        var reEnterPassword = function () {
            if (document.getElementById('password').value != document.getElementById('rePassword').value ) {
				$('#rePassword').addClass('is-invalid');
                $('#signUp').addClass('disabled');
				$('#signUp').prop('type', 'button');
            } else {
				$('#rePassword').removeClass('is-invalid');
                $('#signUp').removeClass('disabled');
                $('#signUp').prop('type', 'submit');
            }
		}

		var checkTerms = function () {
			if (document.getElementById('agreement_checkbox').checked) {
                $('#signUp').prop('type', 'button')
            }
		}

        $("form").submit(function (e) {
            if (!$("input[name='terms']").is(":checked")) {
				e.preventDefault();
                $('#agreement_checkbox').addClass('is-invalid');
            }
        });
	</script>
</body>
</html>


